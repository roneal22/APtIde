<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title></title>
	<script language="javascript">
		const apiKey = '563492ad6f9170000100000140f73cb4a6574a4292f84f64f4001264'; 
		function getPexel() {
			//make request object
			request = new XMLHttpRequest();
			console.log("1 - request object created");
			//set url
			request.open("GET", "https://api.pexels.com/v1/photos/2014422", true)
			//add key to header
			console.log("2 - opened request file");
			request.setRequestHeader("Authorization", apiKey);

			request.onreadystatechange = function() {
				console.log("3 - readystatechange event fired.");
				if (request.readyState == 4 && request.status == 200) {

					// yay!
					console.log("5 - response received");
					result = request.responseText;
					alert(result);
					photoInfo = JSON.parse(result);
					//https://web.dev/samesite-cookie-recipes/
					document.cookie = 'url=' + photoInfo["src"]["large"] + '; SameSite=None; Secure';
					document.cookie = 'url=' + photoInfo["src"]["large"] + '; Secure';
					document.getElementById("photo").innerHTML = "<img src=\"" + photoInfo["src"]["large"] + "\" alt=\"Pexel Image\">";
					//document.getElementById("data").innerHTML = "url: " + photoInfo["url"] + " <br>";
					document.getElementById("data").innerHTML = "photo name: " + photoInfo["photographer"];
					
				}
				else if (request.readyState == 4 && request.status != 200) {

					document.getElementById("data").innerHTML = "something went wrong :( check the logs for more info";
				}

				else if (request.readyState == 3) {

					document.getElementById("data").innerHTML = "Too soon!  Try again";
				}

			}
			//sendo
			request.send();
			console.log("4 - Request sent");

		}
	</script>
</head>

<body onload="getPexel()">
	<br>
	<div id="photo"></div>
	<div id="data"></div>
	<br>
	<a href="https://www.pexels.com">Photos provided by Pexels</a>

</body>
</html>
